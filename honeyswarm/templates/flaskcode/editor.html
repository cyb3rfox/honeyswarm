{% extends 'base.html' %}
{% from 'flaskcode/_macros.html' import render_dir_tree %}

{% block page_title %}{{ app_title }} - {{ dirname }}{% endblock %}





{% block content %}

<div class="row min-vh-100">
    <div class="col">
        <div class="d-flex flex-column h-100">
            <div class="row">
                <div class="col mt-2">
                    <h3>Editing {{honeypot_details.name}}</h3>
                </div>
            </div>

            <div class="row bg-blue flex-grow-1">
                <!-- Start Left Column -->
                <div class="col-4 card">

                        <div class="card-body">

                            <form>
                                <div class="form-group">
                                  <label for="honeypot_name">Name</label>
                                  <input type="text" class="form-control" id="honeypot_name" name="honeypot_name" value="{{honeypot_details.name}}">
                                </div>
                                <div class="form-group">
                                    <label for="honeypot_type">Type</label>
                                    <input type="text" class="form-control" id="honeypot_type" name="honeypot_type" value="{{honeypot_details.honey_type}}">
                                  </div>
                                <div class="form-group">
                                  <label for="honeypot_description">Description</label>
                                  <textarea class="form-control" id="honeypot_description" name="honeypot_description" rows="5">{{honeypot_details.description}}</textarea>
                                </div>

                                <div id="pillar-states" class="form-group">
                                    <p>Pillar States can be used to customise certain aspects of your honeypot when used with salt states. several default pillars are already exposed by default. You can read more in the docs. (When I write them)</p>
                                    <div class="form-row">
                                        <div class="col">
                                          <input type="text" class="form-control" placeholder="Key">
                                        </div>
                                        <div class="col">
                                          <input type="text" class="form-control" placeholder="Default Value">
                                        </div>
                                      </div>
                                      <div class="form-row mt-2">
                                        <div class="col">
                                          <input type="text" class="form-control" placeholder="Key">
                                        </div>
                                        <div class="col">
                                          <input type="text" class="form-control" placeholder="Default Value">
                                        </div>
                                      </div>
                                </div>


                              </form>

                              <hr>

                              <button class="btn btn-success btn-block">Update</button>
                              <button class="btn btn-danger btn-block">Delete</button>

                              <p>Put in a onlick handler for each of the buttons. To ajax form serialze and update existing. </p>

            
        
                        </div>

                </div>
                <!-- End Left Column -->
        
                <!-- Start Editor Column -->
                <div class="col-8 card">
        
        
                    <div id="page-wrapper">
                        <!-- .container -->
                        <div id="page-container" class="container-fluid">
                    
                        <div id="page-row" class="row mt-4">
                            <div id="flaskcode-list" class="col-md-2 col-sm-3 col-xs-3">
                                <!-- <h4 style="white-space:nowrap;"><i class="fa fa-folder" aria-hidden="true"></i> {{ dirname|truncate(20) }}</h4> -->
                                <div class="list-header well well-sm mb-0"><i class="fa fa-folder" aria-hidden="true"></i> {{ dirname|truncate(20) }}</div>
                                <div class="list-container">
                                    {{ render_dir_tree(dtree, 'dir-tree') }}
                                </div>
                            </div>
                            <div id="flaskcode-content " class="col-md-10 col-sm-9 col-xs-9 h-75">
                                <div id="editor-header" class="editor-header well well-sm mb-0">
                                    <strong><i class="fa fa-code" aria-hidden="true"></i> {{ app_title }}</strong>
                                    &nbsp;
                                    <span id="resource-info">
                                        <a href="javascript:void(0);" id="resource-close" class="text-danger" title="Close" style="display:none;"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                                        <span id="resource-name" title=""></span>
                                        <i id="resource-mod" class="text-danger fa fa-asterisk" aria-hidden="true" style="display:none;"></i>
                                    </span>
                                    <span class="pull-right hidden-xs" id="header-action-group">
                                        <a href="javascript:void(0);" class="header-actions" data-action-id="save" title="Save"><span class="badge badge-primary"><i class="fa fa-save" aria-hidden="true"></i> Save</span></a>
                                        &nbsp;|&nbsp;
                                        <a href="javascript:void(0);" class="header-actions" data-action-id="reload" title="Reload"><span class="badge badge-primary"><i class="fa fa-refresh" aria-hidden="true"></i> Reload</span></a>
                                        &nbsp;|&nbsp;
                                        <a href="javascript:void(0);" class="header-actions" data-action-id="force-reload" title="Force Reload"><span class="badge badge-danger"><i class="fa fa-retweet" aria-hidden="true"></i></span></a>
                                        &nbsp;|&nbsp;
                                        <a href="javascript:void(0);" id="toggle-minimap" title="Toggle Minimap"><span class="badge badge-primary"><i class="fa fa-th-list" aria-hidden="true"></i></span></a>
                                    </span>
                                </div>
                                <!-- Editor Widget -->
                                <div id="editor-container" class="editor-container{% if editor_theme == 'vs' %} light-theme{% endif %}">
                                    <div class="editor-preloader" style="display:none;">
                                        <div class="loading-center">
                                            <div class="loading-center-absolute">Requesting...</div>
                                        </div>
                                    </div>
                                    <div class="editor-notification text-center"></div>
                                    <div class="editor-body">
                                        <div class="editor-body-msg">
                                            <h2 class="text-center text-info"><i class="fa fa-code" aria-hidden="true"></i> {{ app_title }}</h2>
                                        </div>
                                    </div>
                                </div>
                                <!-- /Editor Widget -->
                            </div>
                            <footer id="page-footer">
                                <strong><i class="fa fa-code" aria-hidden="true"></i> {{ app_title }}</strong>
                                <span class="hidden-xs">[ <i class="fa fa-folder" aria-hidden="true"></i> {{ dirname }} ]</span>
                                <span class="pull-right">
                                    <span id="editor_lang" title="Detected Language"></span>&nbsp;&nbsp;&nbsp;Ln&nbsp;<span id="line_num"></span>,&nbsp;Col&nbsp;<span id="column_num"></span>
                                </span>
                            </footer>
                        </div>
        
                    
                        <!-- /page-content -->
                    </div>
                    <!-- /.container -->
                    </div>
        
        
        
                </div>
        
            <!-- End Editor Column -->
            </div>


        </div>


        
    


    </div>
</div>










<div id="page-preloader" class="page-preloader">
    <div class="loading-center">
        <div class="loading-center-absolute">
            <i class="fa fa-spinner fa-pulse" aria-hidden="true"></i>
            <br />
            <i class="fa fa-code" aria-hidden="true"></i> {{ app_title }}
            <small><em>v{{ app_version }}</em></small>
        </div>
    </div>
</div>






    <!--Modals-->
    <div id="fileNameModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="fileNameModalLabel">
        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content">
                <form id="fileNameForm" method="post">
                    <input type="hidden" id="base_url" name="base_url" value="" />
                    <input type="hidden" id="base_path_name" name="base_path_name" value="" />
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="fileNameModalLabel">Create New File</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="new_filename" class="control-label">New File:</label>
                                    <div class="input-group">
                                        <div class="input-group-addon"><span class="base-path-name"></span>/</div>
                                        <input type="text" class="form-control" id="new_filename" name="new_filename" placeholder="New File Name" required />
                                    </div>
                                    <span class="form-msg" class="help-block"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" data-loading-text="Loading...">Create</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!--/Modals-->




{% endblock %}

{% block page_styles %}
<link rel="stylesheet" type="text/css" href="{{ url_for('flaskcode.static', filename='vendor/font-awesome/css/font-awesome.min.css') }}" />
<link rel="stylesheet" type="text/css" href="{{ url_for('flaskcode.static', filename='vendor/jquery-contextMenu/jquery.contextMenu.min.css') }}" />
<link rel="stylesheet" type="text/css" href="{{ url_for('flaskcode.static', filename='vendor/treed/treed.css') }}" />
<link rel="stylesheet" type="text/css" href="{{ url_for('flaskcode.static', filename='css/styles.css') }}" />
{% endblock %}

{% block page_scripts %}
<script type="text/javascript" src="{{ url_for('flaskcode.static', filename='vendor/jquery-contextMenu/jquery.contextMenu.min.js') }}"></script>
<script type="text/javascript" src="{{ url_for('flaskcode.static', filename='vendor/monaco-editor/min/vs/loader.js') }}"></script>
<script type="text/javascript" src="{{ url_for('flaskcode.static', filename='vendor/treed/treed.js') }}"></script>
<script type="text/javascript" src="{{ url_for('flaskcode.static', filename='js/objects.js') }}"></script>
<script type="text/javascript">


flaskcode.config.set('pluginsBaseUrl', "{{ url_for('flaskcode.static', filename='vendor') }}");
flaskcode.config.set('updateResourceBaseUrl', "{{ url_for('honeypots.update_resource_data', honeypot_id=honeypot_id,  file_path='') }}");
flaskcode.config.set('resourceUrlTemplate', "{{ url_for('honeypots.resource_data', honeypot_id=honeypot_id, file_path='__pathname__') }}");
flaskcode.config.set('editorTheme', "{{ editor_theme }}");

</script>
<script type="text/javascript" src="{{ url_for('flaskcode.static', filename='js/flaskcode.js') }}"></script>

<script>
    // We need to add some custom extensions. Once the languages have loaded push our supported in
    var addExtensions = setInterval(function() {
    if (flaskcode.languages.length > 0) { 
       flaskcode.languages.find(x => x.id === 'yaml').extensions.push('.sls');
       flaskcode.languages.find(x => x.id === 'shell').extensions.push('.cfg');
       clearInterval(addExtensions);
    }
    }, 100);


</script>

{% endblock %}